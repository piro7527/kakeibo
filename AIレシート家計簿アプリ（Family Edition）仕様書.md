# AIレシート家計簿アプリ（Family Edition）仕様書

## 1. プロジェクト概要
スマートフォンでの利用を主とした、家族向けWebベース家計簿アプリケーション（PWA）。
レシートをカメラで撮影するだけで、Google Gemini APIが内容を解析し、品目・金額・日付・カテゴリを自動でデータベースに登録する。

## 2. ターゲットユーザー & ユースケース
* **ユーザー**: 家族（複数人での共有利用を想定）
* **利用シーン**: 買い物直後の車内や自宅で、スマホから手軽にレシートを登録。
* **ゴール**: 面倒な手入力をゼロにし、家計の可視化を自動化する。

## 3. 技術スタック（推奨構成）
Antigravity（AIエージェント）に指示する際の基本構成です。

* **Frontend**: React (または Next.js) + Tailwind CSS
    * スマホ操作に最適化したUIコンポーネントを使用。
* **Backend / Database**: Firebase
    * **Hosting**: アプリの公開（Webホスティング）。
    * **Authentication**: Googleログイン（家族のみがアクセスできるよう制限）。
    * **Firestore**: データの保存（リアルタイムデータベース）。
    * **Cloud Functions**: Gemini APIへのセキュアなリクエスト処理（APIキーの保護）。
* **AI Model**: Google Gemini 1.5 Flash
    * 画像認識とJSONデータ抽出に使用。

## 4. 機能要件

### 4.1. 認証機能
* Googleアカウントによるログイン/ログアウト。
* 未ログインユーザーのアクセス制限。

### 4.2. レシート登録（メイン機能）
* **カメラ起動/画像アップロード**: スマホのカメラでレシートを撮影、またはライブラリから選択。
* **AI解析**: 画像を送信し、以下の情報を自動抽出する。
    * 日付 (Date)
    * 店舗名 (Merchant)
    * 合計金額 (Total Amount)
    * 明細リスト (Items)
    * **自動カテゴリ分類**: 各品目、またはレシート全体を適切なカテゴリ（食費、日用品、医療費、交通費、その他）に分類。
* **確認・編集画面**: AIの解析結果を表示し、誤りがあれば手動で修正して「保存」ボタンでDB登録。

### 4.3. ダッシュボード（可視化）
* **月次集計**: 今月の支出合計を表示。
* **カテゴリ別グラフ**: 円グラフ（Pie Chart）でカテゴリごとの支出割合を表示。
* **履歴リスト**: 過去の登録データをリスト表示（タップで詳細確認・削除）。

## 5. データ構造 (Firestore Schema案)

`expenses` コレクション
```json
{
  "uid": "user_id_string",       // 登録者のID
  "date": "2026-01-21",          // 購入日
  "merchant": "スーパー〇〇",      // 店舗名
  "totalAmount": 3500,           // 合計金額
  "category": "食費",             // メインカテゴリ
  "items": [                     // 明細（オプション）
    {"name": "牛乳", "price": 200, "category": "食費"},
    {"name": "洗剤", "price": 300, "category": "日用品"}
  ],
  "createdAt": "timestamp"       // 登録日時
}